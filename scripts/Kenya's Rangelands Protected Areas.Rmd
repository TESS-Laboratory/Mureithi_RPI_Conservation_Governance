---
title: "Kenya's Rangelands Protected Areas"
author: "Isaac Mureithi"
date: "2025-04-01"
output:
  html_document: default
  pdf_document: default
  word_document: default
---

```{r}
# Load libraries

library(sf)
library(terra)
library(tidyverse)
library(tidyterra)
library(colorspace)
library(ggrepel)
library(patchwork) # combine plots
```

```{r}
# First of all, I shall create the "theme_beautiful" as discussed in last session

theme_beautiful <- function() {
  theme_bw() +
    theme(
      text = element_text(family = "Helvetica"),
      axis.text = element_text(size = 8, color = "black"),
      axis.title = element_text(size = 8, color = "black"),
      axis.line.x = element_line(size = 0.3, color = "black"),
      axis.line.y = element_line(size = 0.3, color = "black"),
      axis.ticks = element_line(size = 0.3, color = "black"),
      panel.border = element_blank(),
      panel.grid.major.x = element_blank(),
      panel.grid.minor.x = element_blank(),
      panel.grid.minor.y = element_blank(),
      panel.grid.major.y = element_blank(),
      plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"),
      plot.title = element_text(
        size = 8,
        vjust = 1,
        hjust = 0.5,
        color = "black"
      ),
      legend.text = element_text(size = 8, color = "black"),
      legend.title = element_text(size = 8, color = "black"),
      legend.position = c(0.9, 0.9),
      legend.key.size = unit(0.9, "line"),
      legend.background = element_rect(
        color = "black",
        fill = "transparent",
        size = 2,
        linetype = "blank"
      )
    )
}
windowsFonts("Helvetica" = windowsFont("Helvetica"))
```

```{r}
# Addressing the Warnings in the original "theme_beautiful()"

theme_beautiful <- function() {
  theme_bw() +
    theme(
      text = element_text(family = "Helvetica"),
      axis.text = element_text(size = 8, color = "black"),
      axis.title = element_text(size = 8, color = "black"),
      axis.line.x = element_line(linewidth = 0.3, color = "black"), # Use linewidth
      axis.line.y = element_line(linewidth = 0.3, color = "black"), # Use linewidth
      axis.ticks = element_line(linewidth = 0.3, color = "black"), # Use linewidth
      panel.border = element_blank(),
      panel.grid.major.x = element_blank(),
      panel.grid.minor.x = element_blank(),
      panel.grid.minor.y = element_blank(),
      panel.grid.major.y = element_blank(),
      plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"),
      plot.title = element_text(
        size = 8,
        vjust = 1,
        hjust = 0.5,
        color = "black"
      ),
      legend.text = element_text(size = 8, color = "black"),
      legend.title = element_text(size = 8, color = "black"),
      legend.position = "right", # Move legend to the right
      legend.key.size = unit(0.9, "line"),
      legend.background = element_rect(
        color = "black",
        fill = "transparent",
        linewidth = 0.3, # Use linewidth
        linetype = "blank"
      )
    )
}

# Attempt to set the Helvetica font (may not work on all systems)
if (Sys.info()[["sysname"]] == "Windows") {
  windowsFonts("Helvetica" = windowsFont("Helvetica"))
}
```

```{r}
# World Map Import

Global.Country.Boundaries <- st_read("C:/Users/IsaacM/OneDrive/Documents/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/Kenya-s-Rangelands-Protected-Areas_files/additional_data_layers_wgs84/global_country_boundaries_simplified_wgs84.shp")
```

```{r}
# World Map Information

head(Global.Country.Boundaries)
```

```{r}
# Plot of World Map

ggplot() +
  geom_sf(data = Global.Country.Boundaries)+
  labs(title = "World Country Map")+
  theme_beautiful()
```

```{r}
# Africa Country Boundary import

Africa.Country.Boundaries <- st_read("C:/Users/IsaacM/OneDrive/Documents/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/Kenya-s-Rangelands-Protected-Areas_files/additional_data_layers_wgs84/africa_country_boundaries_simplified_wgs84.shp")
```

```{r}
# Information on African Countries Boundaries

head(Africa.Country.Boundaries)
```

```{r}
# Focusing on Eastern Africa

Eastern.Africa.Country.ISOCodes <- c("BI", "DJ", "ER", "ET", "KE", "RW", "SO", "TZ", "UG")
Eastern.Africa.Data <- Africa.Country.Boundaries %>% 
  filter(ISO_Code %in% Eastern.Africa.Country.ISOCodes)
```

```{r}
# Plotting with a focus on Eastern Africa

ggplot() +
  geom_sf(data = Global.Country.Boundaries, fill = "white", colour = "grey") +
  geom_sf(data = Africa.Country.Boundaries, aes(fill = "Africa"), colour = "grey", alpha = 0.5) +
  geom_sf(data = Eastern.Africa.Data, aes(fill = "Eastern Africa"), colour = "black") +
  scale_fill_manual(values = c("Africa" = "lightgreen", "Eastern Africa" = "darkgreen"),
                    name = "Region",labels = c("Africa", "Eastern Africa")) +
  labs(title = "Eastern Africa in World Map")+
  theme_beautiful()
```

```{r}
#Focusing on Kenya

  Kenya.Admin.Boundary <- st_read("C:/Users/IsaacM/OneDrive/Documents/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/Kenya-s-Rangelands-Protected-Areas_files/additional_data_layers_wgs84/kenya_admin_boundary_wgs84.shp")
```

```{r}
# Information about Kenya

head(Kenya.Admin.Boundary)
```

```{r}
# Plotting Kenya

ggplot() +
  geom_sf(data = Eastern.Africa.Data, aes(fill = "Eastern Africa"), alpha = 0.5, colour = NA) +
  geom_sf(data = Kenya.Admin.Boundary, aes(fill = "Kenya"), colour = "black") +
  scale_fill_manual(name = "Region",values = c("Eastern Africa" = "darkgreen", "Kenya" = "lightgreen"))+
  labs(title = "Kenya Administrative Boundary") +
  theme_beautiful()
```

```{r}
#Focusing on Boundaries within Kenya

Kenya.Subregional.Admin.Boundary <- st_read("C:/Users/IsaacM/OneDrive/Documents/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/Kenya-s-Rangelands-Protected-Areas_files/additional_data_layers_wgs84/kenya_subregional_admin2_boundary_wgs84.shp")
```

```{r}
#Information about Kenya's counties

head(Kenya.Subregional.Admin.Boundary)
```

```{r}
# Plotting Kenya's counties

ggplot()+
  geom_sf(data = Kenya.Admin.Boundary, colour = "black")+
  geom_sf(data = Kenya.Subregional.Admin.Boundary, colour = "grey50")+
  labs(title = "Kenya's Subregional Administrative Boundaries") +
  theme_beautiful()
```

```{r}
# Focusing on Kenya's Terrestrial Protected Areas

Kenya.Terrestrial.PAs <- st_read("C:/Users/IsaacM/OneDrive/Documents/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/Kenya-s-Rangelands-Protected-Areas_files/additional_data_layers_wgs84/kenya_terrestrial_protected_areas_wgs84.shp")
```

```{r}
# Information about Kenya's Terrestrial PAs

head(Kenya.Terrestrial.PAs)
```

```{r}
# Plotting Kenya's Terrestrial PAs

ggplot()+
  geom_sf(data = Kenya.Admin.Boundary, colour = "black")+
  geom_sf(data = Kenya.Subregional.Admin.Boundary, colour = "grey50")+
  geom_sf(data = Kenya.Terrestrial.PAs, aes(fill = "Protected Areas"), alpha = 0.5)+
  scale_fill_manual(values = c("Protected Areas" = "brown"),name = "Legend",labels = c("Protected Areas")) +
  labs(title = "Kenya's Terrestrial Protected Areas") +
  theme_beautiful()
```

```{r}
# Focusing on Kenya's Rangelands (80& of Kenya's LandMass)

Rangeland.Counties <- c("Marsabit", "Isiolo", "Meru", "Tharaka-Nithi", "Embu", 
                        "Kitui", "Makueni", "Tana River", "Lamu", "Taita Taveta",
                        "Garissa", "Wajir", "Mandera", "Turkana", "West Pokot",
                        "Samburu", "Baringo", "Laikipia", "Narok", "Kajiado")

Kenya.Rangeland.Counties <- Kenya.Subregional.Admin.Boundary %>% 
  filter(ADM1_EN %in% Rangeland.Counties)
```

```{r}
# Plotting the Rangeland Counties

ggplot()+
  geom_sf(data = Kenya.Admin.Boundary, colour = "black") +
  geom_sf(data = Kenya.Subregional.Admin.Boundary, colour = "grey50") +
  geom_sf(data = Kenya.Rangeland.Counties, aes(fill = "Rangeland Counties")) +
  scale_fill_manual(values = c("Rangeland Counties" = "grey"),name = "Legend",labels = c("Rangeland Counties")) +
  labs(title = "Kenya's Rangeland Counties") +
  theme_beautiful()
```

```{r}
# Works to Join different Layers in Kenya's datasets

Kenya.Terrestrial.PAs <- st_transform(Kenya.Terrestrial.PAs, crs = st_crs(Kenya.Subregional.Admin.Boundary))

# Identify invalid geometries
invalid_PAs <- Kenya.Terrestrial.PAs[!st_is_valid(Kenya.Terrestrial.PAs), ]
invalid_Counties <- Kenya.Subregional.Admin.Boundary[!st_is_valid(Kenya.Subregional.Admin.Boundary), ]

# Fix invalid geometries (if any exist)
Kenya.Terrestrial.PAs <- st_make_valid(Kenya.Terrestrial.PAs)
Kenya.Subregional.Admin.Boundary <- st_make_valid(Kenya.Subregional.Admin.Boundary)


Kenya.Terrestrial.PAs.Counties <- st_join(Kenya.Terrestrial.PAs, Kenya.Subregional.Admin.Boundary[, c("ADM1_EN")])

# Filter protected areas in rangeland counties
Rangeland.PAs <- Kenya.Terrestrial.PAs.Counties %>%
  filter(ADM1_EN %in% Rangeland.Counties)
```

```{r}
# Plotting the Joined Layers of Kenya's PAs - Rangelands

ggplot()+
  geom_sf(data = Kenya.Admin.Boundary, colour = "grey") +
  geom_sf(data = Kenya.Rangeland.Counties, colour = "black", fill = "grey") +
  geom_sf(data = Rangeland.PAs, aes(fill = "Rangeland Protected Areas"), alpha = 0.5) +
  scale_fill_manual(values = c("Rangeland Protected Areas" = "brown"),name = "Legend",labels = c("Rangeland Protected Areas")) +
  labs(title = "Rangeland Protected Areas") +
  theme_beautiful()
```

```{r}
# Focusing on Amboseli, Tsavo East & West National Parks

PAs.Interest <- Kenya.Terrestrial.PAs.Counties %>%
  filter((NAME == "Amboseli" & DESIG == "National Park") |
           (NAME == "Chyulu Hills" & DESIG == "National Park") |
           (NAME == "Tsavo East" & DESIG == "National Park") |
           (NAME == "Tsavo West" & DESIG == "National Park"))
```

```{r}
# Plotting Amboseli, Tsavo E&W NPs as PAs Interest

ggplot() +
  geom_sf(data = Kenya.Admin.Boundary, colour = "grey") +
  geom_sf(data = Kenya.Rangeland.Counties, colour = "black", fill = "grey", alpha = 0.5) +
  geom_sf(data = PAs.Interest %>% filter(NAME %in% c("Tsavo East", "Tsavo West", "Amboseli")),
          aes(fill = NAME), color = "black", size = 1.5, linetype = "solid") +
  scale_fill_manual(values = c("Tsavo West" = "mediumseagreen", 
                               "Tsavo East" = "seagreen",
                               "Amboseli" = "forestgreen")) +
  # Optional addition text labels to highlight the names of the parks
  geom_sf_text(data = PAs.Interest %>% filter(NAME %in% c("Tsavo East", "Tsavo West", "Amboseli")),
               aes(label = NAME), color = "black", size = 4, fontface = "bold") +
  labs(title = "Amboseli & Tsavo Locations", fill = "National Parks") +
  theme_beautiful()
```

```{r}
# Importing RPI Datasets - Rasters (TIFs)

Actual.GPP <- rast("C:/Users/IsaacM/OneDrive/Documents/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/Kenya-s-Rangelands-Protected-Areas_files/RPI Datasets (GuyLomax)/actual_gpp_ea_v2.tif")

Potential.GPP <- rast("C:/Users/IsaacM/OneDrive/Documents/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/Kenya-s-Rangelands-Protected-Areas_files/RPI Datasets (GuyLomax)/potential_gpp_ea_v2.tif")

RPI <- rast("C:/Users/IsaacM/OneDrive/Documents/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/Kenya-s-Rangelands-Protected-Areas_files/RPI Datasets (GuyLomax)/rpi_ea_v2.tif")
```

```{r}
# I shall visualise RPI for the year 2000, as it is the 1st layer

RPI.Yr.2000 <- RPI[["rpi.2000"]]

#then plot

ggplot() +
  geom_spatraster(data = RPI.Yr.2000) +
#  scale_fill_viridis_c(option = "plasma", name = "RPI Value") +
  labs(title = "Relative Primary Productivity Index (RPI) - Year 2000",x = "Longitude",y = "Latitude") +
  coord_sf(crs = st_crs(RPI.Yr.2000)) +  # just to confirm the CRS
  theme_beautiful()
```

```{r}
# Now to check for RPI.Yr.2022

RPI.Yr.2022 <- RPI[["rpi.2022"]]

#then plot

ggplot() +
  geom_spatraster(data = RPI.Yr.2022) +
#  scale_fill_viridis_c(option = "plasma", name = "RPI Value") +
  labs(title = "Relative Primary Productivity Index (RPI) - Year 2000",x = "Longitude",y = "Latitude") +
  coord_sf(crs = st_crs(RPI.Yr.2022)) +  # just to confirm the CRS
  theme_beautiful()
```

```{r}
# Now to check RPI within Kenya.Admin.Boundary for the year 2000

# I shall crop and mask RPI using the Kenya.Admin.Boundary

RPI.Kenya.Yr.2000 <- mask(crop(RPI, Kenya.Admin.Boundary), Kenya.Admin.Boundary)[[1]]
```

```{r}
ggplot() +
  geom_spatraster(data = RPI.Kenya.Yr.2000) +
  geom_sf(data = Kenya.Admin.Boundary, fill = NA, color = "black", size = 0.5) +
  labs(title = "RPI in Kenya Administrative Boundary - 2000") +
  theme_beautiful()
```

```{r}
# Now to check RPI within Kenya.Admin.Boundary for the year 2022

# I shall crop and mask RPI using the Kenya.Admin.Boundary

RPI.Kenya.Yr.2022 <- mask(crop(RPI, Kenya.Admin.Boundary), Kenya.Admin.Boundary)[[23]]
```

```{r}
ggplot() +
  geom_spatraster(data = RPI.Kenya.Yr.2022) +
  geom_sf(data = Kenya.Admin.Boundary, fill = NA, color = "black", size = 0.5) +
  labs(title = "RPI in Kenya Administrative Boundary - 2022") +
  theme_beautiful()
```


```{r}
# I shall now check RPI within Kenya's Rangeland Counties for Year 2000

RPI.Rangeland.Counties.Yr.2000 <- mask(crop(RPI, Kenya.Rangeland.Counties), Kenya.Rangeland.Counties)[[1]]
```

```{r}
ggplot() +
  geom_sf(data = Kenya.Admin.Boundary, fill = NA) +
  geom_spatraster(data = RPI.Rangeland.Counties.Yr.2000) +
  geom_sf(data = Kenya.Rangeland.Counties, fill = NA, color = "black", size = 0.5) +
  labs(title = "RPI in Kenya Rangeland Counties - 2000") +
  theme_beautiful()
```

```{r}
# I shall now check RPI within Kenya's Rangeland Counties for Year 2022

RPI.Rangeland.Counties.Yr.2022 <- mask(crop(RPI, Kenya.Rangeland.Counties), Kenya.Rangeland.Counties)[[23]]
```

```{r}
ggplot() +
  geom_sf(data = Kenya.Admin.Boundary, fill = NA) +
  geom_spatraster(data = RPI.Rangeland.Counties.Yr.2022) +
  geom_sf(data = Kenya.Rangeland.Counties, fill = NA, color = "black", size = 0.5) +
  labs(title = "RPI in Kenya Rangeland Counties - 2022") +
  theme_beautiful()
```

```{r}
# I shall now check for RPI within Rangeland Protected Areas for Year 2000

RPI.Rangeland.PAs.Yr.2000 <- mask(crop(RPI, Rangeland.PAs), Rangeland.PAs)[[1]]
```

```{r}
ggplot() +
  geom_spatraster(data = RPI.Rangeland.PAs.Yr.2000) +
  geom_sf(data = Rangeland.PAs, fill = NA, color = "black", size = 0.5) +
  geom_sf(data = Kenya.Admin.Boundary, alpha = 0) +
  labs(title = "RPI in Rangeland Protected Areas - 2000") +
  theme_beautiful()
```

```{r}
# I shall now check for RPI within Rangeland Protected Areas for Year 2022

RPI.Rangeland.PAs.Yr.2022 <- mask(crop(RPI, Rangeland.PAs), Rangeland.PAs)[[23]]
```

```{r}
ggplot() +
  geom_spatraster(data = RPI.Rangeland.PAs.Yr.2022) +
  geom_sf(data = Rangeland.PAs, fill = NA, color = "black", size = 0.5) +
  geom_sf(data = Kenya.Admin.Boundary, alpha = 0) +
  labs(title = "RPI in Rangeland Protected Areas - 2022") +
  theme_beautiful()
```

```{r}
# Next is checking RPI for NPs of Interest for Year 2000

RPI.PAs.Interest.Yr.2000 <- mask(crop(RPI, PAs.Interest), PAs.Interest)[[1]]
```

```{r}
ggplot() +
  geom_sf(data = Kenya.Admin.Boundary, fill = NA) +
  geom_spatraster(data = RPI.PAs.Interest.Yr.2000) +
  geom_sf(data = PAs.Interest, fill = NA, color = "black", size = 0.5) +
  labs(title = "RPI in Protected Areas of Interest - 2000") +
  theme_beautiful()
```

```{r}
# Next is checking RPI for NPs of Interest for Year 2022

RPI.PAs.Interest.Yr.2022 <- mask(crop(RPI, PAs.Interest), PAs.Interest)[[23]]
```

```{r}
ggplot() +
  geom_sf(data = Kenya.Admin.Boundary, fill = NA) +
  geom_spatraster(data = RPI.PAs.Interest.Yr.2022) +
  geom_sf(data = PAs.Interest, fill = NA, color = "black", size = 0.5) +
  labs(title = "RPI in Protected Areas of Interest - 2022") +
  theme_beautiful()
```

```{r}
# Trying to see the change from 2000 to 2022 in the Area of Interest (Greater Amboseli Ecosystem)

# Create the first plot for the year 2000
plot.RPI.PAs.Interest.Yr.2000 <- ggplot() +
  geom_spatraster(data = RPI.PAs.Interest.Yr.2000) +
  geom_sf(data = PAs.Interest, fill = NA, color = "black", linewidth = 0.5) +
#  scale_fill_viridis_c(option = "plasma", name = "RPI") + # Adds a color scale
  labs(title = "RPI in Protected Areas of Interest - 2000") +
  theme_beautiful()

# Create the second plot for the year 2022
plot.RPI.PAs.Interest.Yr.2022 <- ggplot() +
  geom_spatraster(data = RPI.PAs.Interest.Yr.2022) +
  geom_sf(data = PAs.Interest, fill = NA, color = "black", linewidth = 0.5) +
#  scale_fill_viridis_c(option = "plasma", name = "RPI") + # Adds a color scale
  labs(title = "RPI in Protected Areas of Interest - 2022") +
  theme_beautiful()

# Combine the two plots into a single output
comparison.plot.RPI.PAs.Interest <- plot.RPI.PAs.Interest.Yr.2000 + plot.RPI.PAs.Interest.Yr.2022

```

```{r}
# Display the combined plot
print(comparison.plot.RPI.PAs.Interest)
```

```{r}
# RPI Metrics
```

```{r}
# Mean RPI per Year for Kenya
```

```{r}
# 1a. Extract mean RPI for the single Kenya polygon
RPI.Kenya.Raw <- terra::extract(RPI, Kenya.Admin.Boundary, fun = mean, na.rm = TRUE)

# terra::extract returns a data.frame with columns:
#   ID, rpi.2000, rpi.2001, …, rpi.2022
```

```{r}
# 1b. Turn into a tidy time‐series

RPI.Kenya.TS <- as_tibble(RPI.Kenya.Raw) %>%
  pivot_longer(cols = starts_with("rpi."), names_to  = "Year", values_to = "Mean.RPI") %>%
  mutate(Year = as.integer(sub("rpi\\.", "", Year)))
```

```{r}
# 1c. Plot

ggplot(RPI.Kenya.TS, aes(x = Year, y = Mean.RPI)) +
  geom_line(size = 1) +
  geom_point(size = 2) +
  labs(title = "Mean RPI (2000–2022) for Kenya",x = "Year",y = "Mean RPI") +
  theme_beautiful()
```

```{r}
# Mean RPI per Year for each Rangeland-ecosystem County
```

```{r}
# 2a. Extract mean RPI for each county (multiple polygons)

RPI.Rangeland.Counties.Raw <- terra::extract(RPI, Kenya.Rangeland.Counties, fun = mean, na.rm = TRUE)
```

```{r}
# Bind county names back on

RPI.Rangeland.Counties.Raw$ADM1_EN <- Kenya.Rangeland.Counties$ADM1_EN

RPI.Rangeland.Counties.Raw$ADM2_EN <- Kenya.Rangeland.Counties$ADM2_EN
```

```{r}
# 2b. Tidy

RPI.Rangeland.Counties.TS <- as_tibble(RPI.Rangeland.Counties.Raw) %>%
  pivot_longer(cols = starts_with("rpi."), names_to  = "Year", values_to = "Mean.RPI") %>%
  mutate(Year = as.integer(sub("rpi\\.", "", Year)))
```

```{r}
# 2c. Example: Taking a look at Amboseli NP which falls in Kajiado South (Admin2) - under Kajiado (Admin1)

RPI.Rangeland.Counties.TS %>%
  filter(ADM2_EN == "Kajiado South") %>%
  ggplot(aes(x = Year, y = Mean.RPI)) +
    geom_line() +
    geom_point() +
    labs(title = "Mean RPI in Kajiado South (2000–2022)", x = "Year", y = "Mean RPI") +
    theme_beautiful()
```

```{r}

# Placing all Rangeland Counties on one plot

ggplot(RPI.Rangeland.Counties.TS, aes(x = Year, y = Mean.RPI, color = ADM1_EN)) +
  geom_line() +
  labs(title = "Mean RPI (2000–2022) by Rangeland County", x = "Year", y = "Mean RPI", color = "County") +
  theme_beautiful()
```

```{r}
# Trying to make the above look beautiful with Utility 2 - visualising scientific interests in key terms

ggplot(RPI.Rangeland.Counties.TS, aes(x = Year, y = Mean.RPI, color = ADM1_EN)) +
  geom_line(linewidth = 0.8) +
  labs(title = "Mean RPI by Rangeland County (2000-2022)",
    x = "Year",
    y = "Mean RPI",
    color = "County"
  ) +
#  scale_color_viridis(discrete = TRUE, option = "plasma") + # Using a viridis palette
  scale_x_continuous(breaks = seq(2000, 2022, by = 2)) + # Show year labels every 2 years
  theme_beautiful() +
  theme(legend.position = "right",
        legend.text = element_text(size = 9),
        legend.title = element_text(size = 10),
        plot.title = element_text(hjust = 0.5, size = 12))
```

```{r}
# Mean RPI per Year for the Rangeland Protected Areas
```

```{r}
# 3a. Extract & bind name

RPI.PAs.Raw <- terra::extract(RPI, Rangeland.PAs, fun = mean, na.rm = TRUE)

RPI.PAs.Raw$NAME <- Rangeland.PAs$NAME
```

```{r}
# 3b. Tidy

RPI.PAs.TS <- as_tibble(RPI.PAs.Raw) %>%
  pivot_longer(cols = starts_with("rpi."), names_to  = "Year", values_to = "Mean.RPI") %>%
  mutate(Year = as.integer(sub("rpi\\.", "", Year)))
```

```{r}
# 3c. Plot all PAs of the rangeland

ggplot(RPI.PAs.TS, aes(x = Year, y = Mean.RPI, color = NAME)) +
  geom_line() +
  labs(
    title = "Mean RPI (2000–2022) in Rangeland Protected Areas",
    x = "Year",
    y = "Mean RPI",
    color = "Protected Area"
  ) +
  theme_beautiful()
```

```{r}
# Mean RPI per Year for Greater Amboseli Ecosystem - National Parks only
```

```{r}
# 4a. Extract & bind name

RPI.PAs.Interest.Raw <- terra::extract(RPI, PAs.Interest, fun = mean, na.rm = TRUE)

RPI.PAs.Interest.Raw$NAME <- PAs.Interest$NAME
```

```{r}
# 4b. Tidy

RPI.PAs.Interest.TS <- as_tibble(RPI.PAs.Interest.Raw) %>%
  pivot_longer(cols = starts_with("rpi."), names_to  = "Year", values_to = "Mean.RPI") %>%
  mutate(Year = as.integer(sub("rpi\\.", "", Year)))
```

```{r}
# 4c. Plot

ggplot(RPI.PAs.Interest.TS, aes(x = Year, y = Mean.RPI, color = NAME)) +
  geom_line(size = 1) +
  geom_point(size = 2) +
  labs(
    title = "Mean RPI (2000–2022) in Selected National Parks",
    x = "Year",
    y = "Mean RPI",
    color = "National Park"
  ) +
  theme_beautiful()
```

```{r}
# ROUGH WORK ON STATS

# Mean RPI across all Years
Mean.RPI <- terra::app(RPI, fun = mean, na.rm = TRUE)


ggplot() +
  geom_spatraster(data = Mean.RPI) +
  geom_sf(data = Kenya.Admin.Boundary, fill = NA, color = "black") +
  labs(title = "Mean RPI (2000–2022) Across Kenya") +
  theme_beautiful()
```

```{r}
#Variability (Standard Deviation) of RPI across the Years
SD.RPI <- terra::app(RPI, fun = sd, na.rm = TRUE)

ggplot() +
  geom_spatraster(data = SD.RPI) +
#  scale_fill_viridis(option = "magma", name = "RPI Std. Dev.") +
  labs(title = "Temporal Standard Deviation of RPI (2000-2022)", fill = "RPI Std. Dev.") +
  coord_sf(crs = st_crs(SD.RPI)) +
  theme_beautiful()
```

```{r}
# MAPS SOURCED FROM WDPA
```


```{r}
# Importing National Parks & National Reserves (GAE/TSAVOs)

Amboseli <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/National Parks&Reserves/Amboseli-WDPA_WDOECM_Apr2025_Public_758_shp/WDPA_WDOECM_Apr2025_Public_758_shp_0/WDPA_WDOECM_Apr2025_Public_758_shp-polygons.shp")
ChyuluHills <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/National Parks&Reserves/ChyuluHills-WDPA_WDOECM_Apr2025_Public_19563_shp/WDPA_WDOECM_Apr2025_Public_19563_shp_0/WDPA_WDOECM_Apr2025_Public_19563_shp-polygons.shp")
TsavoWest <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/National Parks&Reserves/TsavoWest-WDPA_WDOECM_Apr2025_Public_19564_shp/WDPA_WDOECM_Apr2025_Public_19564_shp_0/WDPA_WDOECM_Apr2025_Public_19564_shp-polygons.shp")
TsavoEast <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/National Parks&Reserves/TsavoEast-WDPA_WDOECM_Apr2025_Public_752_shp/WDPA_WDOECM_Apr2025_Public_752_shp_0/WDPA_WDOECM_Apr2025_Public_752_shp-polygons.shp")
NgaiNdethia <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/National Parks&Reserves/NgaiNdethia-WDPA_WDOECM_Apr2025_Public_2595_shp/WDPA_WDOECM_Apr2025_Public_2595_shp_0/WDPA_WDOECM_Apr2025_Public_2595_shp-polygons.shp")
```

```{r}
# Visualising GAE/TSAVOs

ggplot()+
  geom_sf(data = Kenya.Admin.Boundary) +
  geom_sf(data = Amboseli) +
  geom_sf(data = ChyuluHills) +
  geom_sf(data = TsavoEast) +
  geom_sf(data = TsavoWest) +
  geom_sf(data = NgaiNdethia) +
  labs(title = "GAE/TSAVOs - National Parks & Reserves")
```

```{r}
# Importing Community Conservancies & Group Ranches

DawidaRanch_T <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/DawidaRanch(T)-WDPA_WDOECM_Apr2025_Public_72297_shp/WDPA_WDOECM_Apr2025_Public_72297_shp_0/WDPA_WDOECM_Apr2025_Public_72297_shp-points.shp")
Elerai_A <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/Elerai(A)-WDPA_WDOECM_Apr2025_Public_555555482_shp/WDPA_WDOECM_Apr2025_Public_555555482_shp_0/WDPA_WDOECM_Apr2025_Public_555555482_shp-polygons.shp")
Eselenkei_A <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/Esenlenkei(A)-WDPA_WDOECM_Apr2025_Public_555555485_shp/WDPA_WDOECM_Apr2025_Public_555555485_shp_0/WDPA_WDOECM_Apr2025_Public_555555485_shp-polygons.shp")
Imbirikani_A <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/Imbirikani(A)-WDPA_WDOECM_Apr2025_Public_72283_shp/WDPA_WDOECM_Apr2025_Public_72283_shp_0/WDPA_WDOECM_Apr2025_Public_72283_shp-polygons.shp")
Kasigau_T <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/Kasigau(T)-WDPA_WDOECM_Apr2025_Public_7582_shp/WDPA_WDOECM_Apr2025_Public_7582_shp_0/WDPA_WDOECM_Apr2025_Public_7582_shp-polygons.shp")
Kimana_A <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/Kimana(A)-WDPA_WDOECM_Apr2025_Public_555555481_shp/WDPA_WDOECM_Apr2025_Public_555555481_shp_0/WDPA_WDOECM_Apr2025_Public_555555481_shp-polygons.shp")
KukuGroupRanch_A <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/KukuGroupRanch(A)-WDPA_WDOECM_Apr2025_Public_72290_shp/WDPA_WDOECM_Apr2025_Public_72290_shp_0/WDPA_WDOECM_Apr2025_Public_72290_shp-points.shp")
MbuliaGroupRanch_T <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/MbuliaGroupRanch(T)-WDPA_WDOECM_Apr2025_Public_72293_shp/WDPA_WDOECM_Apr2025_Public_72293_shp_0/WDPA_WDOECM_Apr2025_Public_72293_shp-points.shp")
Mnjonyi_T <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/Mnjonyi(T)-WDPA_WDOECM_Apr2025_Public_555785981_shp/WDPA_WDOECM_Apr2025_Public_555785981_shp_0/WDPA_WDOECM_Apr2025_Public_555785981_shp-polygons.shp")
Motikanju_A <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/Motikanju(A)-WDPA_WDOECM_Apr2025_Public_555555486_shp/WDPA_WDOECM_Apr2025_Public_555555486_shp_0/WDPA_WDOECM_Apr2025_Public_555555486_shp-polygons.shp")
Mwaganini_T <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/Mwaganini(T)-WDPA_WDOECM_Apr2025_Public_555785983_shp/WDPA_WDOECM_Apr2025_Public_555785983_shp_0/WDPA_WDOECM_Apr2025_Public_555785983_shp-polygons.shp")
Nailepu_A <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/Nailepu(A)-WDPA_WDOECM_Apr2025_Public_555555488_shp/WDPA_WDOECM_Apr2025_Public_555555488_shp_0/WDPA_WDOECM_Apr2025_Public_555555488_shp-polygons.shp")
Osupuko_A <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/Osupuko(A)-WDPA_WDOECM_Apr2025_Public_555555487_shp/WDPA_WDOECM_Apr2025_Public_555555487_shp_0/WDPA_WDOECM_Apr2025_Public_555555487_shp-polygons.shp")
Ronge_T <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/Ronge(T)-WDPA_WDOECM_Apr2025_Public_555785982_shp/WDPA_WDOECM_Apr2025_Public_555785982_shp_0/WDPA_WDOECM_Apr2025_Public_555785982_shp-polygons.shp")
TaitaHills_T <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/TaitaHills(T)-WDPA_WDOECM_Apr2025_Public_7408_shp/WDPA_WDOECM_Apr2025_Public_7408_shp_0/WDPA_WDOECM_Apr2025_Public_7408_shp-polygons.shp")
Tawi_A <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/Tawi(A)-WDPA_WDOECM_Apr2025_Public_555555489_shp/WDPA_WDOECM_Apr2025_Public_555555489_shp_0/WDPA_WDOECM_Apr2025_Public_555555489_shp-polygons.shp")
```

```{r}
# Visualising the Community Conservancies & Group Ranches

ggplot()+
  geom_sf(data = Kenya.Admin.Boundary) +
  geom_sf(data = DawidaRanch_T) +
  geom_sf(data = Elerai_A) +
  geom_sf(data = Eselenkei_A) +
  geom_sf(data = Imbirikani_A) +
  geom_sf(data = Kasigau_T) +
  geom_sf(data = Kimana_A) +
  geom_sf(data = KukuGroupRanch_A) +
  geom_sf(data = MbuliaGroupRanch_T) +
  geom_sf(data = Mnjonyi_T) +
  geom_sf(data = Motikanju_A) +
  geom_sf(data = Mwaganini_T) +
  geom_sf(data = Nailepu_A) +
  geom_sf(data = Osupuko_A) +
  geom_sf(data = Ronge_T) +
  geom_sf(data = TaitaHills_T) +
  geom_sf(data = Tawi_A) +
  labs(title = "Community & Group Ranches - GAE/TSAVOs")
```

```{r}
# Visualising the Community Conservancies & Group Ranches in GAE/TSAVOs

ggplot() +
  # geom_sf(data = Kenya.Admin.Boundary) +
  geom_sf(data = Amboseli, aes(fill = "Forest Areas"), color = 'black', linewidth = 0.1) +
  geom_sf(data = ChyuluHills, aes(fill = "Forest Areas"), color = 'black', linewidth = 0.1) +
  geom_sf(data = TsavoEast, aes(fill = "Forest Areas"), color = 'black', linewidth = 0.1) +
  geom_sf(data = TsavoWest, aes(fill = "Forest Areas"), color = 'black', linewidth = 0.1) +
  geom_sf(data = NgaiNdethia, aes(fill = "Forest Areas"), color = 'black', linewidth = 0.1) +
  geom_sf(data = DawidaRanch_T, aes(fill = "Dawida Ranch_T"), color = 'black', linewidth = 0.1) +
  geom_sf(data = Elerai_A, aes(fill = "Elerai"), color = 'black', linewidth = 0.1) +
  geom_sf(data = Eselenkei_A, aes(fill = "Eselenkei"), color = 'black', linewidth = 0.1) +
  geom_sf(data = Imbirikani_A, aes(fill = "Imbirikani"), color = 'black', linewidth = 0.1) +
  geom_sf(data = Kasigau_T, aes(fill = "Kasigau"), color = 'black', linewidth = 0.1) +
  geom_sf(data = Kimana_A, aes(fill = "Kimana"), color = 'black', linewidth = 0.1) +
  geom_sf(data = KukuGroupRanch_A, aes(fill = "Kuku Group Ranch_A"), color = 'black', linewidth = 0.1) +
  geom_sf(data = MbuliaGroupRanch_T, aes(fill = "Mbulia Group Ranch_T"), color = 'black', linewidth = 0.1) +
  geom_sf(data = Mnjonyi_T, aes(fill = "Mnjonyi"), color = 'black', linewidth = 0.1) +
  geom_sf(data = Motikanju_A, aes(fill = "Motikanju"), color = 'black', linewidth = 0.1) +
  geom_sf(data = Mwaganini_T, aes(fill = "Mwaganini"), color = 'black', linewidth = 0.1) +
  geom_sf(data = Nailepu_A, aes(fill = "Nailepu"), color = 'black', linewidth = 0.1) +
  geom_sf(data = Osupuko_A, aes(fill = "Osupuko"), color = 'black', linewidth = 0.1) +
  geom_sf(data = Ronge_T, aes(fill = "Ronge"), color = 'black', linewidth = 0.1) +
  geom_sf(data = TaitaHills_T, aes(fill = "Taita Hills"), color = 'black', linewidth = 0.1) +
  geom_sf(data = Tawi_A, aes(fill = "Tawi"), color = 'black', linewidth = 0.1) +
  scale_fill_manual(values = c(
    "Forest Areas" = "forestgreen",
    "Dawida Ranch_T" = "lightblue",
    "Elerai" = "orange",
    "Eselenkei" = "purple",
    "Imbirikani" = "brown",
    "Kasigau" = "yellow",
    "Kimana" = "pink",
    "Kuku Group Ranch_A" = "cyan",
    "Mbulia Group Ranch_T" = "magenta",
    "Mnjonyi" = "gray",
    "Motikanju" = "darkred",
    "Mwaganini" = "darkblue",
    "Nailepu" = "lightcoral",
    "Osupuko" = "darkgreen",
    "Ronge" = "goldenrod",
    "Taita Hills" = "darkcyan",
    "Tawi" = "deeppink"
  ), name = "Protected Area") +
  labs(title = "Community & Group Ranches in GAE/TSAVOs") +
  theme_beautiful()
```

```{r}