---
title: "Kenya's Rangelands Protected Areas"
author: "Isaac Mureithi"
date: "2025-04-01"
output:
  html_document: default
  pdf_document: default
  word_document: default
---

```{r}
# Load libraries

if (!require("pacman")) install.packages("pacman")

pacman::p_load(sf, terra, tidyverse, tidyterra, colorspace, ggrepel, patchwork, tmap)
```

```{r}
# First of all, I shall create the "theme_beautiful" as discussed in last session

theme_beautiful <- function() {
  theme_bw() +
    theme(
      text = element_text(family = "Helvetica"),
      axis.text = element_text(size = 8, color = "black"),
      axis.title = element_text(size = 8, color = "black"),
      axis.line.x = element_line(size = 0.3, color = "black"),
      axis.line.y = element_line(size = 0.3, color = "black"),
      axis.ticks = element_line(size = 0.3, color = "black"),
      panel.border = element_blank(),
      panel.grid.major.x = element_blank(),
      panel.grid.minor.x = element_blank(),
      panel.grid.minor.y = element_blank(),
      panel.grid.major.y = element_blank(),
      plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"),
      plot.title = element_text(
        size = 8,
        vjust = 1,
        hjust = 0.5,
        color = "black"
      ),
      legend.text = element_text(size = 8, color = "black"),
      legend.title = element_text(size = 8, color = "black"),
      legend.position = c(0.9, 0.9),
      legend.key.size = unit(0.9, "line"),
      legend.background = element_rect(
        color = "black",
        fill = "transparent",
        size = 2,
        linetype = "blank"
      )
    )
}
windowsFonts("Helvetica" = windowsFont("Helvetica"))
```

```{r}
# Addressing the Warnings in the original "theme_beautiful()"

theme_beautiful <- function() {
  theme_bw() +
    theme(
      text = element_text(family = "Helvetica"),
      axis.text = element_text(size = 8, color = "black"),
      axis.title = element_text(size = 8, color = "black"),
      axis.line.x = element_line(linewidth = 0.3, color = "black"), # Use linewidth
      axis.line.y = element_line(linewidth = 0.3, color = "black"), # Use linewidth
      axis.ticks = element_line(linewidth = 0.3, color = "black"), # Use linewidth
      panel.border = element_blank(),
      panel.grid.major.x = element_blank(),
      panel.grid.minor.x = element_blank(),
      panel.grid.minor.y = element_blank(),
      panel.grid.major.y = element_blank(),
      plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), "cm"),
      plot.title = element_text(
        size = 8,
        vjust = 1,
        hjust = 0.5,
        color = "black"
      ),
      legend.text = element_text(size = 8, color = "black"),
      legend.title = element_text(size = 8, color = "black"),
      legend.position = "right", # Move legend to the right
      legend.key.size = unit(0.9, "line"),
      legend.background = element_rect(
        color = "black",
        fill = "transparent",
        linewidth = 0.3, # Use linewidth
        linetype = "blank"
      )
    )
}

# Attempt to set the Helvetica font (may not work on all systems)
if (Sys.info()[["sysname"]] == "Windows") {
  windowsFonts("Helvetica" = windowsFont("Helvetica"))
}
```

```{r}
# World Map Import

Global.Country.Boundaries <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/2.Kenya-s-Rangelands-Protected-Areas_files/additional_data_layers_wgs84/global_country_boundaries_simplified_wgs84.shp")
```

```{r}
# Plot of World Map

ggplot() +
  geom_sf(data = Global.Country.Boundaries)+
  labs(title = "World Country Map")+
  theme_beautiful()
```

```{r}
# Africa Country Boundary import

Africa.Country.Boundaries <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/2.Kenya-s-Rangelands-Protected-Areas_files/additional_data_layers_wgs84/africa_country_boundaries_simplified_wgs84.shp")
```

```{r}
# Focusing on Eastern Africa

Eastern.Africa.Country.ISOCodes <- c("BI", "DJ", "ER", "ET", "KE", "RW", "SO", "TZ", "UG")
Eastern.Africa.Data <- Africa.Country.Boundaries %>% 
  filter(ISO_Code %in% Eastern.Africa.Country.ISOCodes)
```

```{r}
# Plotting with a focus on Eastern Africa

ggplot() +
  geom_sf(data = Global.Country.Boundaries, fill = "white", colour = "grey") +
  geom_sf(data = Africa.Country.Boundaries, aes(fill = "Africa"), colour = "grey", alpha = 0.5) +
  geom_sf(data = Eastern.Africa.Data, aes(fill = "Eastern Africa"), colour = "black") +
  scale_fill_manual(values = c("Africa" = "lightgreen", "Eastern Africa" = "darkgreen"),
                    name = "Region",labels = c("Africa", "Eastern Africa")) +
  labs(title = "Eastern Africa in World Map")+
  theme_beautiful()
```

```{r}
#Focusing on Kenya

  Kenya.Admin.Boundary <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/2.Kenya-s-Rangelands-Protected-Areas_files/additional_data_layers_wgs84/kenya_admin_boundary_wgs84.shp")
```

```{r}
# Plotting Kenya

ggplot() +
  geom_sf(data = Eastern.Africa.Data, aes(fill = "Eastern Africa"), alpha = 0.5, colour = NA) +
  geom_sf(data = Kenya.Admin.Boundary, aes(fill = "Kenya"), colour = "black") +
  scale_fill_manual(name = "Region",values = c("Eastern Africa" = "darkgreen", "Kenya" = "lightgreen"))+
  labs(title = "Kenya Administrative Boundary") +
  theme_beautiful()
```

```{r}
#Focusing on Boundaries within Kenya

Kenya.Regional.Admin.Boundary <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/2.Kenya-s-Rangelands-Protected-Areas_files/additional_data_layers_wgs84/kenya_regional_admin1_boundary_wgs84.shp")
```

```{r}
# Plotting Kenya's Regional Boundaries

ggplot()+
  geom_sf(data = Kenya.Admin.Boundary, colour = "black")+
  geom_sf(data = Kenya.Regional.Admin.Boundary, colour = "grey50")+
  labs(title = "Kenya's Subregional Administrative Boundaries") +
  theme_beautiful()
```

```{r}
# Focusing on Kenya's Terrestrial Protected Areas

Kenya.Terrestrial.PAs <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/2.Kenya-s-Rangelands-Protected-Areas_files/additional_data_layers_wgs84/kenya_terrestrial_protected_areas_wgs84.shp")
```

```{r}
# Plotting Kenya's Terrestrial PAs

ggplot()+
  geom_sf(data = Kenya.Admin.Boundary, colour = "black")+
  geom_sf(data = Kenya.Regional.Admin.Boundary, colour = "grey50")+
  geom_sf(data = Kenya.Terrestrial.PAs, aes(fill = "Protected Areas"), alpha = 0.5)+
  scale_fill_manual(values = c("Protected Areas" = "brown"),name = "Legend",labels = c("Protected Areas")) +
  labs(title = "Kenya's Terrestrial Protected Areas") +
  theme_beautiful()
```

```{r}
# Focusing on Kenya's Rangelands (80& of Kenya's LandMass)

Rangeland.Counties <- c("Marsabit", "Isiolo", "Meru", "Tharaka-Nithi", "Embu", 
                        "Kitui", "Makueni", "Tana River", "Lamu", "Taita Taveta",
                        "Garissa", "Wajir", "Mandera", "Turkana", "West Pokot",
                        "Samburu", "Baringo", "Laikipia", "Narok", "Kajiado")

Kenya.Rangeland.Counties <- Kenya.Regional.Admin.Boundary %>% 
  filter(ADM1_EN %in% Rangeland.Counties)
```

```{r}
# Plotting the Rangeland Counties

ggplot()+
  geom_sf(data = Kenya.Admin.Boundary, colour = "black") +
  geom_sf(data = Kenya.Regional.Admin.Boundary, colour = "grey50") +
  geom_sf(data = Kenya.Rangeland.Counties, aes(fill = "Rangeland Counties")) +
  scale_fill_manual(values = c("Rangeland Counties" = "grey"),name = "Legend",labels = c("Rangeland Counties")) +
  labs(title = "Kenya's Rangeland Counties") +
  theme_beautiful()
```

```{r}
# Importing RPI Datasets - Rasters (TIFs)

Actual.GPP <- rast("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/2.Kenya-s-Rangelands-Protected-Areas_files/RPI Datasets (GuyLomax)/actual_gpp_ea_v2.tif")

Potential.GPP <- rast("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/2.Kenya-s-Rangelands-Protected-Areas_files/RPI Datasets (GuyLomax)/potential_gpp_ea_v2.tif")

RPI <- rast("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/2.Kenya-s-Rangelands-Protected-Areas_files/RPI Datasets (GuyLomax)/rpi_ea_v2.tif")
```

```{r}
# MAPS SOURCED FROM WDPA

# "UNEP-WCMC and IUCN (2025), Protected Planet: The World Database on Protected Areas (WDPA) and World Database on Other Effective Area-based Conservation Measures (WD-OECM) [Online], April 2025, Cambridge, UK: UNEP-WCMC and IUCN. Available at: www.protectedplanet.net." 
```

```{r}
# Importing National Parks & National Reserves (GAE/TCA)

Amboseli <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/National Parks&Reserves/Amboseli-WDPA_WDOECM_Apr2025_Public_758_shp/WDPA_WDOECM_Apr2025_Public_758_shp_0/WDPA_WDOECM_Apr2025_Public_758_shp-polygons.shp")

ChyuluHills <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/National Parks&Reserves/ChyuluHills-WDPA_WDOECM_Apr2025_Public_19563_shp/WDPA_WDOECM_Apr2025_Public_19563_shp_0/WDPA_WDOECM_Apr2025_Public_19563_shp-polygons.shp")

TsavoWest <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/National Parks&Reserves/TsavoWest-WDPA_WDOECM_Apr2025_Public_19564_shp/WDPA_WDOECM_Apr2025_Public_19564_shp_0/WDPA_WDOECM_Apr2025_Public_19564_shp-polygons.shp")

TsavoEast <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/National Parks&Reserves/TsavoEast-WDPA_WDOECM_Apr2025_Public_752_shp/WDPA_WDOECM_Apr2025_Public_752_shp_0/WDPA_WDOECM_Apr2025_Public_752_shp-polygons.shp")

NgaiNdethia <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/National Parks&Reserves/NgaiNdethia-WDPA_WDOECM_Apr2025_Public_2595_shp/WDPA_WDOECM_Apr2025_Public_2595_shp_0/WDPA_WDOECM_Apr2025_Public_2595_shp-polygons.shp")

SouthKitui <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/National Parks&Reserves/SouthKitui-WDPA_WDOECM_Apr2025_Public_2590_shp/WDPA_WDOECM_Apr2025_Public_2590_shp_0/WDPA_WDOECM_Apr2025_Public_2590_shp-polygons.shp")
```

```{r}
# Visualising GAE/TCA

ggplot() +
  geom_sf(data = Amboseli, aes(fill = NAME), color = "black", linewidth = 0.3) +
  geom_sf(data = ChyuluHills, aes(fill = NAME), color = "black", linewidth = 0.3) +
  geom_sf(data = TsavoEast, aes(fill = NAME), color = "black", linewidth = 0.3) +
  geom_sf(data = TsavoWest, aes(fill = NAME), color = "black", linewidth = 0.3) +
  geom_sf(data = NgaiNdethia, aes(fill = NAME), color = "black", linewidth = 0.3) +
  geom_sf(data = SouthKitui, aes(fill = NAME), color = "black", linewidth = 0.3) +
  labs(title = "National Parks and Reserves under Study", fill = "Protected Area") +
  theme_beautiful()
```

```{r}
# Importing Community Conservancies & Group Ranches

AET.Conservancies <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/5. AET-Conservancies/AET_Conservancies.shp")

AET.Others <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/5. AET-Conservancies/AET_Other_Conserved_Areas.shp")

DawidaRanch_T <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/DawidaRanch(T)-WDPA_WDOECM_Apr2025_Public_72297_shp/WDPA_WDOECM_Apr2025_Public_72297_shp_0/WDPA_WDOECM_Apr2025_Public_72297_shp-points.shp")

Kasigau_T <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/Kasigau(T)-WDPA_WDOECM_Apr2025_Public_7582_shp/WDPA_WDOECM_Apr2025_Public_7582_shp_0/WDPA_WDOECM_Apr2025_Public_7582_shp-polygons.shp")

MbuliaGroupRanch_T <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/MbuliaGroupRanch(T)-WDPA_WDOECM_Apr2025_Public_72293_shp/WDPA_WDOECM_Apr2025_Public_72293_shp_0/WDPA_WDOECM_Apr2025_Public_72293_shp-points.shp")

Mnjonyi_T <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/Mnjonyi(T)-WDPA_WDOECM_Apr2025_Public_555785981_shp/WDPA_WDOECM_Apr2025_Public_555785981_shp_0/WDPA_WDOECM_Apr2025_Public_555785981_shp-polygons.shp")

Mwaganini_T <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/Mwaganini(T)-WDPA_WDOECM_Apr2025_Public_555785983_shp/WDPA_WDOECM_Apr2025_Public_555785983_shp_0/WDPA_WDOECM_Apr2025_Public_555785983_shp-polygons.shp")

Ronge_T <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/Ronge(T)-WDPA_WDOECM_Apr2025_Public_555785982_shp/WDPA_WDOECM_Apr2025_Public_555785982_shp_0/WDPA_WDOECM_Apr2025_Public_555785982_shp-polygons.shp")

TaitaHills_T <- st_read("C:/BIOM4009 ResearchProject/DATA/Geospatial Data/R Use/4.WDPA-GAE&TSAVOs/Community&Groups/TaitaHills(T)-WDPA_WDOECM_Apr2025_Public_7408_shp/WDPA_WDOECM_Apr2025_Public_7408_shp_0/WDPA_WDOECM_Apr2025_Public_7408_shp-polygons.shp")
```

```{r}
# Visualising the Community Conservancies & Group Ranches within GAE/TCA

ggplot()+
  geom_sf(data = AET.Conservancies, aes(fill = consv_name), color = "black", linewidth = 0.1) +
  #geom_sf(data = AET.Others, aes(fill = consv_name), color = "black", linewidth = 0.1) +
  geom_sf(data = DawidaRanch_T, aes(fill = NAME), color = 'black', linewidth = 0.1) +
  geom_sf(data = Kasigau_T, aes(fill = NAME), color = 'black', linewidth = 0.1) +
  geom_sf(data = Mnjonyi_T, aes(fill = NAME), color = 'black', linewidth = 0.1) +
  geom_sf(data = MbuliaGroupRanch_T, aes(fill = NAME), color = 'black', linewidth = 0.1) +
  geom_sf(data = Mwaganini_T, aes(fill = NAME), color = 'black', linewidth = 0.1) +
  geom_sf(data = Ronge_T, aes(fill = NAME), color = 'black', linewidth = 0.1) +
  geom_sf(data = TaitaHills_T, aes(fill = NAME), color = 'black', linewidth = 0.1) +
  labs(title = "Community & Group Ranches in GAE/TCA") +
  theme_beautiful()
```

```{r}
# Visualising the Community & Group Lands surrounding Amboseli NP

ggplot()+
  geom_sf(data = Amboseli, aes(fill = NAME), color = "black", linewidth = 0.3) +
  geom_sf(data = AET.Conservancies, aes(fill = consv_name), color = "black", linewidth = 0.1) +
  labs(title = "Community & Group Lands surrounding Amboseli NP") +
  theme_beautiful()
```

```{r}
# Visualising the Community & Group Rangelands/Grazelands/Buffers surrounding Amboseli NP

ggplot()+
 geom_sf(data = Amboseli, aes(fill = NAME), color = "black", linewidth = 0.3) +
  geom_sf(data = AET.Others, aes(fill = consv_name), color = "black", linewidth = 0.1) +
  labs(title = "Bufferzones, Corridors & Grazelands surrounding Amboseli NP") +
  theme_beautiful()
```

```{r}
# Visualising RPI for each Area
```

```{r}
## Visualising Amboseli NP

Amboseli.RPI.Mask <- mask(RPI, Amboseli)
Amboseli.RPI.Crop <- crop(Amboseli.RPI.Mask, Amboseli)

# Averaging across years for visualization
Amboseli.RPI.Mean <- mean(Amboseli.RPI.Crop, na.rm = TRUE)

# Visualise
tmap_mode("view")
tm_shape(Amboseli.RPI.Mean) +
  tm_raster(col.scale = tm_scale_continuous(values = "viridis"), 
            col.legend = tm_legend(title = "Mean RPI")) +
  tm_shape(Amboseli) +
  tm_borders(col = "white", lwd = 2)
```

```{r}
## Visualising Tsavo East NP

TsavoEast.RPI.Mask <- mask(RPI, TsavoEast)
TsavoEast.RPI.Crop <- crop(TsavoEast.RPI.Mask, TsavoEast)

# Averaging across years for visualization
TsavoEast.RPI.Mean <- mean(TsavoEast.RPI.Crop, na.rm = TRUE)

# Visualise
tmap_mode("view")
tm_shape(TsavoEast.RPI.Mean) +
  tm_raster(col.scale = tm_scale_continuous(values = "viridis"), 
            col.legend = tm_legend(title = "Mean RPI")) +
  tm_shape(TsavoEast) +
  tm_borders(col = "white", lwd = 2)
```

```{r}
## Visualising Tsavo West NP

TsavoWest.RPI.Mask <- mask(RPI, TsavoWest)
TsavoWest.RPI.Crop <- crop(TsavoWest.RPI.Mask, TsavoWest)

# Averaging across years for visualization
TsavoWest.RPI.Mean <- mean(TsavoWest.RPI.Crop, na.rm = TRUE)

# Visualise
tmap_mode("view")
tm_shape(TsavoWest.RPI.Mean) +
  tm_raster(col.scale = tm_scale_continuous(values = "viridis"), 
            col.legend = tm_legend(title = "Mean RPI")) +
  tm_shape(TsavoWest) +
  tm_borders(col = "white", lwd = 2)
```

```{r}
## Visualising Chyulu Hills NP

ChyuluHills.RPI.Mask <- mask(RPI, ChyuluHills)
ChyuluHills.RPI.Crop <- crop(ChyuluHills.RPI.Mask, ChyuluHills)

# Averaging across years for visualization
ChyuluHills.RPI.Mean <- mean(ChyuluHills.RPI.Crop, na.rm = TRUE)

# Visualise
tmap_mode("view")
tm_shape(ChyuluHills.RPI.Mean) +
  tm_raster(col.scale = tm_scale_continuous(values = "viridis"), 
            col.legend = tm_legend(title = "Mean RPI")) +
  tm_shape(ChyuluHills) +
  tm_borders(col = "white", lwd = 2)
```

```{r}
## Visualising Ngai Ndethia NR

NgaiNdethia.RPI.Mask <- mask(RPI, NgaiNdethia)
NgaiNdethia.RPI.Crop <- crop(NgaiNdethia.RPI.Mask, NgaiNdethia)

# Averaging across years for visualization
NgaiNdethia.RPI.Mean <- mean(NgaiNdethia.RPI.Crop, na.rm = TRUE)

# Visualise
tmap_mode("view")
tm_shape(NgaiNdethia.RPI.Mean) +
  tm_raster(col.scale = tm_scale_continuous(values = "viridis"), 
            col.legend = tm_legend(title = "Mean RPI")) +
  tm_shape(NgaiNdethia) +
  tm_borders(col = "white", lwd = 2)
```

```{r}
## Visualising South Kitui NR

SouthKitui.RPI.Mask <- mask(RPI, SouthKitui)
SouthKitui.RPI.Crop <- crop(SouthKitui.RPI.Mask, SouthKitui)

# Averaging across years for visualization
SouthKitui.RPI.Mean <- mean(SouthKitui.RPI.Crop, na.rm = TRUE)

# Visualise
tmap_mode("view")
tm_shape(SouthKitui.RPI.Mean) +
  tm_raster(col.scale = tm_scale_continuous(values = "viridis"), 
            col.legend = tm_legend(title = "Mean RPI")) +
  tm_shape(SouthKitui) +
  tm_borders(col = "white", lwd = 2)
```

```{r}
## Visualising AET.Conservancies

AET.Conservancies.RPI.Mask <- mask(RPI, AET.Conservancies)
AET.Conservancies.RPI.Crop <- crop(AET.Conservancies.RPI.Mask, AET.Conservancies)

# Averaging across years for visualization
AET.Conservancies.RPI.Mean <- mean(AET.Conservancies.RPI.Crop, na.rm = TRUE)

# Visualise
tmap_mode("view")
tm_shape(AET.Conservancies.RPI.Mean) +
  tm_raster(col.scale = tm_scale_continuous(values = "viridis"), 
            col.legend = tm_legend(title = "Mean RPI")) +
  tm_shape(AET.Conservancies) +
  tm_borders(col = "white", lwd = 2)
```

```{r}
## Visualising AET.Others

AET.Others.RPI.Mask <- mask(RPI, AET.Others)
AET.Others.RPI.Crop <- crop(AET.Others.RPI.Mask, AET.Others)

# Averaging across years for visualization
AET.Others.RPI.Mean <- mean(AET.Others.RPI.Crop, na.rm = TRUE)

# Visualise
tmap_mode("view")
tm_shape(AET.Others.RPI.Mean) +
  tm_raster(col.scale = tm_scale_continuous(values = "viridis"), 
            col.legend = tm_legend(title = "Mean RPI")) +
  tm_shape(AET.Others) +
  tm_borders(col = "white", lwd = 2)
```

```{r}
# Extracting RPI Values for each Area
```

```{r}
## Extracting RPI for Amboseli NP

Amboseli.RPI.Values <- terra::extract(Amboseli.RPI.Crop, Amboseli)

### Remove ID column (first column added by extract)
Amboseli.RPI.Values <- Amboseli.RPI.Values[, -1]

Amboseli.Summary <- data.frame(
  Layer = names(Amboseli.RPI.Crop),
  Mean = apply(Amboseli.RPI.Values, 2, mean, na.rm = TRUE),
  SD = apply(Amboseli.RPI.Values, 2, sd, na.rm = TRUE),
  Q25 = apply(Amboseli.RPI.Values, 2, quantile, probs = 0.25, na.rm = TRUE),
  Median = apply(Amboseli.RPI.Values, 2, median, na.rm = TRUE),
  Q75 = apply(Amboseli.RPI.Values, 2, quantile, probs = 0.75, na.rm = TRUE)
)

print(Amboseli.Summary)
```

```{r}
## Extracting RPI for TsavoEast NP

TsavoEast.RPI.Values <- terra::extract(TsavoEast.RPI.Crop, TsavoEast)

### Remove ID column (first column added by extract)
TsavoEast.RPI.Values <- TsavoEast.RPI.Values[, -1]

TsavoEast.Summary <- data.frame(
  Layer = names(TsavoEast.RPI.Crop),
  Mean = apply(TsavoEast.RPI.Values, 2, mean, na.rm = TRUE),
  SD = apply(TsavoEast.RPI.Values, 2, sd, na.rm = TRUE),
  Q25 = apply(TsavoEast.RPI.Values, 2, quantile, probs = 0.25, na.rm = TRUE),
  Median = apply(TsavoEast.RPI.Values, 2, median, na.rm = TRUE),
  Q75 = apply(TsavoEast.RPI.Values, 2, quantile, probs = 0.75, na.rm = TRUE)
)

print(TsavoEast.Summary)
```

```{r}
## Extracting RPI for TsavoWest NP

TsavoWest.RPI.Values <- terra::extract(TsavoWest.RPI.Crop, TsavoWest)

### Remove ID column (first column added by extract)
TsavoWest.RPI.Values <- TsavoWest.RPI.Values[, -1]

TsavoWest.Summary <- data.frame(
  Layer = names(TsavoWest.RPI.Crop),
  Mean = apply(TsavoWest.RPI.Values, 2, mean, na.rm = TRUE),
  SD = apply(TsavoWest.RPI.Values, 2, sd, na.rm = TRUE),
  Q25 = apply(TsavoWest.RPI.Values, 2, quantile, probs = 0.25, na.rm = TRUE),
  Median = apply(TsavoWest.RPI.Values, 2, median, na.rm = TRUE),
  Q75 = apply(TsavoWest.RPI.Values, 2, quantile, probs = 0.75, na.rm = TRUE)
)

print(TsavoWest.Summary)
```

```{r}
## Extracting RPI for ChyuluHills NP

ChyuluHills.RPI.Values <- terra::extract(ChyuluHills.RPI.Crop, ChyuluHills)

### Remove ID column (first column added by extract)
ChyuluHills.RPI.Values <- ChyuluHills.RPI.Values[, -1]

ChyuluHills.Summary <- data.frame(
  Layer = names(ChyuluHills.RPI.Crop),
  Mean = apply(ChyuluHills.RPI.Values, 2, mean, na.rm = TRUE),
  SD = apply(ChyuluHills.RPI.Values, 2, sd, na.rm = TRUE),
  Q25 = apply(ChyuluHills.RPI.Values, 2, quantile, probs = 0.25, na.rm = TRUE),
  Median = apply(ChyuluHills.RPI.Values, 2, median, na.rm = TRUE),
  Q75 = apply(ChyuluHills.RPI.Values, 2, quantile, probs = 0.75, na.rm = TRUE)
)

print(ChyuluHills.Summary)
```

```{r}
## Extracting RPI for NgaiNdethia NR

NgaiNdethia.RPI.Values <- terra::extract(NgaiNdethia.RPI.Crop, NgaiNdethia)

### Remove ID column (first column added by extract)
NgaiNdethia.RPI.Values <- NgaiNdethia.RPI.Values[, -1]

NgaiNdethia.Summary <- data.frame(
  Layer = names(NgaiNdethia.RPI.Crop),
  Mean = apply(NgaiNdethia.RPI.Values, 2, mean, na.rm = TRUE),
  SD = apply(NgaiNdethia.RPI.Values, 2, sd, na.rm = TRUE),
  Q25 = apply(NgaiNdethia.RPI.Values, 2, quantile, probs = 0.25, na.rm = TRUE),
  Median = apply(NgaiNdethia.RPI.Values, 2, median, na.rm = TRUE),
  Q75 = apply(NgaiNdethia.RPI.Values, 2, quantile, probs = 0.75, na.rm = TRUE)
)

print(NgaiNdethia.Summary)
```

```{r}
## Extracting RPI for SouthKitui NR

SouthKitui.RPI.Values <- terra::extract(SouthKitui.RPI.Crop, SouthKitui)

### Remove ID column (first column added by extract)
SouthKitui.RPI.Values <- SouthKitui.RPI.Values[, -1]

SouthKitui.Summary <- data.frame(
  Layer = names(SouthKitui.RPI.Crop),
  Mean = apply(SouthKitui.RPI.Values, 2, mean, na.rm = TRUE),
  SD = apply(SouthKitui.RPI.Values, 2, sd, na.rm = TRUE),
  Q25 = apply(SouthKitui.RPI.Values, 2, quantile, probs = 0.25, na.rm = TRUE),
  Median = apply(SouthKitui.RPI.Values, 2, median, na.rm = TRUE),
  Q75 = apply(SouthKitui.RPI.Values, 2, quantile, probs = 0.75, na.rm = TRUE)
)

print(SouthKitui.Summary)
```

```{r}
## Extracting RPI for AET.Conservancies

AET.Conservancies.RPI.Values <- terra::extract(AET.Conservancies.RPI.Crop, AET.Conservancies)

### Remove ID column (first column added by extract)
AET.Conservancies.RPI.Values <- AET.Conservancies.RPI.Values[, -1]

AET.Conservancies.Summary <- data.frame(
  Layer = names(AET.Conservancies.RPI.Crop),
  Mean = apply(AET.Conservancies.RPI.Values, 2, mean, na.rm = TRUE),
  SD = apply(AET.Conservancies.RPI.Values, 2, sd, na.rm = TRUE),
  Q25 = apply(AET.Conservancies.RPI.Values, 2, quantile, probs = 0.25, na.rm = TRUE),
  Median = apply(AET.Conservancies.RPI.Values, 2, median, na.rm = TRUE),
  Q75 = apply(AET.Conservancies.RPI.Values, 2, quantile, probs = 0.75, na.rm = TRUE)
)

print(AET.Conservancies.Summary)
```

```{r}
## Extracting RPI for AET.Others

AET.Others.RPI.Values <- terra::extract(AET.Others.RPI.Crop, AET.Others)

### Remove ID column (first column added by extract)
AET.Others.RPI.Values <- AET.Others.RPI.Values[, -1]

AET.Others.Summary <- data.frame(
  Layer = names(AET.Others.RPI.Crop),
  Mean = apply(AET.Others.RPI.Values, 2, mean, na.rm = TRUE),
  SD = apply(AET.Others.RPI.Values, 2, sd, na.rm = TRUE),
  Q25 = apply(AET.Others.RPI.Values, 2, quantile, probs = 0.25, na.rm = TRUE),
  Median = apply(AET.Others.RPI.Values, 2, median, na.rm = TRUE),
  Q75 = apply(AET.Others.RPI.Values, 2, quantile, probs = 0.75, na.rm = TRUE)
)

print(AET.Others.Summary)
```

```{r}
# Visualising Extracted RPI Values
```

```{r}
## Visualising Amboseli NP

Amboseli.RPI.Visual <- Amboseli.RPI.Values %>%
  mutate(ID = row_number()) %>%  # optional, to keep track of pixels
  pivot_longer(
    cols = -ID,                 # exclude ID column from pivoting
    names_to = "Layer",
    values_to = "RPI_value"
  ) %>%
  # Keep only layers starting with "rpi."
  filter(grepl("^rpi\\.", Layer)) %>%
  mutate(
    Year = as.integer(sub("rpi\\.", "", Layer)),
    Area = "Amboseli"
  ) %>%
  filter(!is.na(Year) & !is.na(RPI_value)) %>%  # remove NA years or RPI values
  select(Area, Year, RPI_value)

# Now plot
ggplot(Amboseli.RPI.Visual, aes(x = factor(Year), y = RPI_value)) +
  geom_boxplot(fill = "lightblue", outlier.color = "red") +
  labs(
    title = "RPI Distribution Over Years in Amboseli NP",
    x = "Year",
    y = "RPI Value"
  ) +
  theme_beautiful()
```

```{r}
## Visualising Amboseli NP (using a Violin Plot)

ggplot(Amboseli.RPI.Visual, aes(x = factor(Year), y = RPI_value)) +
  geom_violin(fill = "lightblue", color = "black", alpha = 0.7) +
  geom_boxplot(width = 0.1, outlier.color = "red", alpha = 0.5) +  # optional: overlay boxplot for summary stats
  labs(
    title = "RPI Distribution Over Years in Amboseli NP (Violin Plot)",
    x = "Year",
    y = "RPI Value"
  ) +
  theme_beautiful()
```

```{r}
## Visualising TsavoEast NP

TsavoEast.RPI.Visual <- TsavoEast.RPI.Values %>%
  mutate(ID = row_number()) %>%  # optional, to keep track of pixels
  pivot_longer(
    cols = -ID,                 # exclude ID column from pivoting
    names_to = "Layer",
    values_to = "RPI_value"
  ) %>%
  # Keep only layers starting with "rpi."
  filter(grepl("^rpi\\.", Layer)) %>%
  mutate(
    Year = as.integer(sub("rpi\\.", "", Layer)),
    Area = "TsavoEast"
  ) %>%
  filter(!is.na(Year) & !is.na(RPI_value)) %>%  # remove NA years or RPI values
  select(Area, Year, RPI_value)

# Now plot
ggplot(TsavoEast.RPI.Visual, aes(x = factor(Year), y = RPI_value)) +
  geom_boxplot(fill = "lightblue", outlier.color = "red") +
  labs(
    title = "RPI Distribution Over Years in TsavoEast NP",
    x = "Year",
    y = "RPI Value"
  ) +
  theme_beautiful()
```

```{r}
## Visualising TsavoEast NP (using a Violin Plot)

ggplot(TsavoEast.RPI.Visual, aes(x = factor(Year), y = RPI_value)) +
  geom_violin(fill = "lightblue", color = "black", alpha = 0.7) +
  geom_boxplot(width = 0.1, outlier.color = "red", alpha = 0.5) +  # optional: overlay boxplot for summary stats
  labs(
    title = "RPI Distribution Over Years in TsavoEast NP (Violin Plot)",
    x = "Year",
    y = "RPI Value"
  ) +
  theme_beautiful()
```

```{r}
## Visualising TsavoWest NP

TsavoWest.RPI.Visual <- TsavoWest.RPI.Values %>%
  mutate(ID = row_number()) %>%  # optional, to keep track of pixels
  pivot_longer(
    cols = -ID,                 # exclude ID column from pivoting
    names_to = "Layer",
    values_to = "RPI_value"
  ) %>%
  # Keep only layers starting with "rpi."
  filter(grepl("^rpi\\.", Layer)) %>%
  mutate(
    Year = as.integer(sub("rpi\\.", "", Layer)),
    Area = "TsavoWest"
  ) %>%
  filter(!is.na(Year) & !is.na(RPI_value)) %>%  # remove NA years or RPI values
  select(Area, Year, RPI_value)

# Now plot
ggplot(TsavoWest.RPI.Visual, aes(x = factor(Year), y = RPI_value)) +
  geom_boxplot(fill = "lightblue", outlier.color = "red") +
  labs(
    title = "RPI Distribution Over Years in TsavoWest NP",
    x = "Year",
    y = "RPI Value"
  ) +
  theme_beautiful()
```

```{r}
## Visualising TsavoWest NP (using a Violin Plot)

ggplot(TsavoWest.RPI.Visual, aes(x = factor(Year), y = RPI_value)) +
  geom_violin(fill = "lightblue", color = "black", alpha = 0.7) +
  geom_boxplot(width = 0.1, outlier.color = "red", alpha = 0.5) +  # optional: overlay boxplot for summary stats
  labs(
    title = "RPI Distribution Over Years in TsavoWest NP (Violin Plot)",
    x = "Year",
    y = "RPI Value"
  ) +
  theme_beautiful()
```

```{r}
## Visualising ChyuluHills NP

ChyuluHills.RPI.Visual <- ChyuluHills.RPI.Values %>%
  mutate(ID = row_number()) %>%  # optional, to keep track of pixels
  pivot_longer(
    cols = -ID,                 # exclude ID column from pivoting
    names_to = "Layer",
    values_to = "RPI_value"
  ) %>%
  # Keep only layers starting with "rpi."
  filter(grepl("^rpi\\.", Layer)) %>%
  mutate(
    Year = as.integer(sub("rpi\\.", "", Layer)),
    Area = "ChyuluHills"
  ) %>%
  filter(!is.na(Year) & !is.na(RPI_value)) %>%  # remove NA years or RPI values
  select(Area, Year, RPI_value)

# Now plot
ggplot(ChyuluHills.RPI.Visual, aes(x = factor(Year), y = RPI_value)) +
  geom_boxplot(fill = "lightblue", outlier.color = "red") +
  labs(
    title = "RPI Distribution Over Years in ChyuluHills NP",
    x = "Year",
    y = "RPI Value"
  ) +
  theme_beautiful()
```

```{r}
## Visualising ChyuluHills NP (using a Violin Plot)

ggplot(ChyuluHills.RPI.Visual, aes(x = factor(Year), y = RPI_value)) +
  geom_violin(fill = "lightblue", color = "black", alpha = 0.7) +
  geom_boxplot(width = 0.1, outlier.color = "red", alpha = 0.5) +  # optional: overlay boxplot for summary stats
  labs(
    title = "RPI Distribution Over Years in ChyuluHills NP (Violin Plot)",
    x = "Year",
    y = "RPI Value"
  ) +
  theme_beautiful()
```

```{r}
## Visualising NgaiNdethia NR

NgaiNdethia.RPI.Visual <- NgaiNdethia.RPI.Values %>%
  mutate(ID = row_number()) %>%  # optional, to keep track of pixels
  pivot_longer(
    cols = -ID,                 # exclude ID column from pivoting
    names_to = "Layer",
    values_to = "RPI_value"
  ) %>%
  # Keep only layers starting with "rpi."
  filter(grepl("^rpi\\.", Layer)) %>%
  mutate(
    Year = as.integer(sub("rpi\\.", "", Layer)),
    Area = "NgaiNdethia"
  ) %>%
  filter(!is.na(Year) & !is.na(RPI_value)) %>%  # remove NA years or RPI values
  select(Area, Year, RPI_value)

# Now plot
ggplot(NgaiNdethia.RPI.Visual, aes(x = factor(Year), y = RPI_value)) +
  geom_boxplot(fill = "lightblue", outlier.color = "red") +
  labs(
    title = "RPI Distribution Over Years in NgaiNdethia NR",
    x = "Year",
    y = "RPI Value"
  ) +
  theme_beautiful()
```

```{r}
## Visualising NgaiNdethia NR (using a Violin Plot)

ggplot(NgaiNdethia.RPI.Visual, aes(x = factor(Year), y = RPI_value)) +
  geom_violin(fill = "lightblue", color = "black", alpha = 0.7) +
  geom_boxplot(width = 0.1, outlier.color = "red", alpha = 0.5) +  # optional: overlay boxplot for summary stats
  labs(
    title = "RPI Distribution Over Years in NgaiNdethia NR (Violin Plot)",
    x = "Year",
    y = "RPI Value"
  ) +
  theme_beautiful()
```

```{r}
## Visualising SouthKitui NR

SouthKitui.RPI.Visual <- SouthKitui.RPI.Values %>%
  mutate(ID = row_number()) %>%  # optional, to keep track of pixels
  pivot_longer(
    cols = -ID,                 # exclude ID column from pivoting
    names_to = "Layer",
    values_to = "RPI_value"
  ) %>%
  # Keep only layers starting with "rpi."
  filter(grepl("^rpi\\.", Layer)) %>%
  mutate(
    Year = as.integer(sub("rpi\\.", "", Layer)),
    Area = "SouthKitui"
  ) %>%
  filter(!is.na(Year) & !is.na(RPI_value)) %>%  # remove NA years or RPI values
  select(Area, Year, RPI_value)

# Now plot
ggplot(SouthKitui.RPI.Visual, aes(x = factor(Year), y = RPI_value)) +
  geom_boxplot(fill = "lightblue", outlier.color = "red") +
  labs(
    title = "RPI Distribution Over Years in SouthKitui NR",
    x = "Year",
    y = "RPI Value"
  ) +
  theme_beautiful()
```

```{r}
## Visualising SouthKitui NR (using a Violin Plot)

ggplot(SouthKitui.RPI.Visual, aes(x = factor(Year), y = RPI_value)) +
  geom_violin(fill = "lightblue", color = "black", alpha = 0.7) +
  geom_boxplot(width = 0.1, outlier.color = "red", alpha = 0.5) +  # optional: overlay boxplot for summary stats
  labs(
    title = "RPI Distribution Over Years in SouthKitui NR (Violin Plot)",
    x = "Year",
    y = "RPI Value"
  ) +
  theme_beautiful()
```

```{r}
## Visualising AET.Conservancies

AET.Conservancies.RPI.Visual <- AET.Conservancies.RPI.Values %>%
  mutate(ID = row_number()) %>%  # optional, to keep track of pixels
  pivot_longer(
    cols = -ID,                 # exclude ID column from pivoting
    names_to = "Layer",
    values_to = "RPI_value"
  ) %>%
  # Keep only layers starting with "rpi."
  filter(grepl("^rpi\\.", Layer)) %>%
  mutate(
    Year = as.integer(sub("rpi\\.", "", Layer)),
    Area = "AET.Conservancies"
  ) %>%
  filter(!is.na(Year) & !is.na(RPI_value)) %>%  # remove NA years or RPI values
  select(Area, Year, RPI_value)

# Now plot
ggplot(AET.Conservancies.RPI.Visual, aes(x = factor(Year), y = RPI_value)) +
  geom_boxplot(fill = "lightblue", outlier.color = "red") +
  labs(
    title = "RPI Distribution Over Years in AET.Conservancies",
    x = "Year",
    y = "RPI Value"
  ) +
  theme_beautiful()
```

```{r}
## Visualising AET.Conservancies (using a Violin Plot)

ggplot(AET.Conservancies.RPI.Visual, aes(x = factor(Year), y = RPI_value)) +
  geom_violin(fill = "lightblue", color = "black", alpha = 0.7) +
  geom_boxplot(width = 0.1, outlier.color = "red", alpha = 0.5) +  # optional: overlay boxplot for summary stats
  labs(
    title = "RPI Distribution Over Years in AET.Conservancies (Violin Plot)",
    x = "Year",
    y = "RPI Value"
  ) +
  theme_beautiful()
```

```{r}
## Visualising AET.Others

AET.Others.RPI.Visual <- AET.Others.RPI.Values %>%
  mutate(ID = row_number()) %>%  # optional, to keep track of pixels
  pivot_longer(
    cols = -ID,                 # exclude ID column from pivoting
    names_to = "Layer",
    values_to = "RPI_value"
  ) %>%
  # Keep only layers starting with "rpi."
  filter(grepl("^rpi\\.", Layer)) %>%
  mutate(
    Year = as.integer(sub("rpi\\.", "", Layer)),
    Area = "AET.Others"
  ) %>%
  filter(!is.na(Year) & !is.na(RPI_value)) %>%  # remove NA years or RPI values
  select(Area, Year, RPI_value)

# Now plot
ggplot(AET.Others.RPI.Visual, aes(x = factor(Year), y = RPI_value)) +
  geom_boxplot(fill = "lightblue", outlier.color = "red") +
  labs(
    title = "RPI Distribution Over Years in AET.Others",
    x = "Year",
    y = "RPI Value"
  ) +
  theme_beautiful()
```

```{r}
## Visualising AET.Others (using a Violin Plot)

ggplot(AET.Others.RPI.Visual, aes(x = factor(Year), y = RPI_value)) +
  geom_violin(fill = "lightblue", color = "black", alpha = 0.7) +
  geom_boxplot(width = 0.1, outlier.color = "red", alpha = 0.5) +  # optional: overlay boxplot for summary stats
  labs(
    title = "RPI Distribution Over Years in AET.Others (Violin Plot)",
    x = "Year",
    y = "RPI Value"
  ) +
  theme_beautiful()
```

```{r}
